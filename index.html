<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Invent√°rio de Esquemas de Young - Consult√≥rio Virtual</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,600;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">

<style>
  :root {
    --cream: #F7F4EF;
    --warm-white: #F7F4EF;
    --sage: #4A2F26;
    --sage-light: #7A5A50;
    --sage-dark: #321f18;
    --terracotta: #C38A6B;
    --terracotta-light: #D9AA90;
    --charcoal: #4A2F26;
    --gray-mid: #7A6560;
    --gray-light: #DDD8D0;
    --border: #E4DDD5;
    --shadow: rgba(74,47,38,0.07);
    --error-red: #A84848;
  }

  * { margin:0; padding:0; box-sizing:border-box; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--cream);
    color: var(--charcoal);
    min-height: 100vh;
    font-size: 15px;
  }

  /* ‚îÄ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ */
  .header {
    background: #F7F4EF;
    border-bottom: 1px solid var(--border);
    padding: 18px 32px;
    display: flex;
    align-items: center;
    gap: 14px;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 1px 8px var(--shadow);
  }
  .header-logo {
    width: 36px; height: 36px;
    background: var(--charcoal);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
  }
  .header-logo svg { width:18px; height:18px; fill: white; }
  .header-title {
    font-family: 'Lora', serif;
    font-size: 17px;
    font-weight: 600;
    color: var(--charcoal);
    letter-spacing: 0.01em;
  }
  .header-subtitle {
    font-size: 12px;
    color: var(--gray-mid);
    font-weight: 300;
  }
  .progress-bar-wrap {
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: 12px;
    min-width: 220px;
  }
  .progress-track {
    flex:1; height: 6px;
    background: var(--gray-light);
    border-radius: 99px;
    overflow: hidden;
  }
  .progress-fill {
    height: 100%;
    background: var(--sage);
    border-radius: 99px;
    transition: width 0.4s ease;
    width: 0%;
  }
  .progress-text {
    font-size: 12px;
    color: var(--gray-mid);
    font-weight: 500;
    white-space: nowrap;
  }

  /* ‚îÄ‚îÄ‚îÄ SCREENS ‚îÄ‚îÄ‚îÄ */
  .screen { display: none; }
  .screen.active { display: block; }

  /* ‚îÄ‚îÄ‚îÄ INTRO SCREEN ‚îÄ‚îÄ‚îÄ */
  .intro-wrap {
    max-width: 720px;
    margin: 60px auto;
    padding: 0 24px;
  }
  .intro-badge {
    display: inline-block;
    background: transparent;
    color: var(--terracotta);
    font-size: 11px;
    font-weight: 500;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 0;
    border-bottom: 1px solid var(--terracotta);
    margin-bottom: 24px;
  }
  .intro-heading {
    font-family: 'Lora', serif;
    font-size: 38px;
    line-height: 1.25;
    color: var(--charcoal);
    margin-bottom: 12px;
  }
  .intro-heading em { color: var(--charcoal); font-style: italic; opacity: 0.7; }
  .intro-desc {
    color: var(--gray-mid);
    line-height: 1.7;
    font-weight: 300;
    margin-bottom: 40px;
    font-size: 15px;
  }
  .instructions-box {
    background: var(--warm-white);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 32px;
    margin-bottom: 36px;
  }
  .instructions-box h3 {
    font-family: 'Lora', serif;
    font-size: 16px;
    margin-bottom: 16px;
    color: var(--charcoal);
  }
  .instructions-box p {
    color: var(--gray-mid);
    line-height: 1.75;
    font-weight: 300;
    font-size: 14px;
    margin-bottom: 20px;
  }
  .scale-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
  }
  .scale-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 12px;
    background: var(--cream);
    border-radius: 8px;
  }
  .scale-num {
    width: 26px; height: 26px;
    background: var(--charcoal);
    color: #F7F4EF;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 12px;
    font-weight: 500;
    flex-shrink: 0;
  }
  .scale-label { font-size: 13px; color: var(--gray-mid); font-weight: 300; }

  .patient-form {
    background: var(--warm-white);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 32px;
    margin-bottom: 36px;
  }
  .patient-form h3 {
    font-family: 'Lora', serif;
    font-size: 16px;
    margin-bottom: 20px;
  }
  .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
  .form-group { display: flex; flex-direction: column; gap: 6px; margin-bottom: 16px; }
  .form-group label {
    font-size: 12px;
    font-weight: 500;
    color: var(--gray-mid);
    text-transform: uppercase;
    letter-spacing: 0.06em;
  }
  .form-group input {
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 11px 14px;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    background: var(--cream);
    color: var(--charcoal);
    outline: none;
    transition: border-color 0.2s;
  }
  .form-group input:focus { border-color: var(--charcoal); }

  .btn-start {
    display: block;
    width: 100%;
    padding: 16px;
    background: var(--sage);
    color: #F7F4EF;
    border: none;
    border-radius: 12px;
    font-family: 'DM Sans', sans-serif;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: background 0.2s, transform 0.1s;
    letter-spacing: 0.02em;
  }
  .btn-start:hover { background: var(--sage-dark); transform: translateY(-1px); }

  /* ‚îÄ‚îÄ‚îÄ QUESTIONS SCREEN ‚îÄ‚îÄ‚îÄ */
  .questions-wrap {
    max-width: 760px;
    margin: 0 auto;
    padding: 40px 24px 80px;
  }
  .domain-header {
    margin-bottom: 32px;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--border);
  }
  .domain-tag {
    display: inline-block;
    font-size: 11px;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--terracotta);
    margin-bottom: 8px;
  }
  .domain-name {
    font-family: 'Lora', serif;
    font-size: 22px;
    color: var(--charcoal);
  }

  .question-card {
    background: var(--warm-white);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 24px 28px;
    margin-bottom: 16px;
    transition: all 0.2s;
  }
  .question-card.answered { border-color: #D4C8C2; }
  .question-card.missing { border: 2px solid var(--error-red); background: #FFF9F9; }
  
  .question-header { display: flex; gap: 14px; align-items: flex-start; margin-bottom: 18px; }
  .question-num {
    flex-shrink: 0; width: 28px; height: 28px;
    border: 1.5px solid var(--gray-light);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 11px; font-weight: 500; color: var(--gray-mid);
  }
  .question-card.answered .question-num { background: var(--terracotta); border-color: var(--terracotta); color: #F7F4EF; }
  
  .question-text { font-size: 15px; line-height: 1.6; color: var(--charcoal); }
  .scale-options { display: flex; gap: 8px; flex-wrap: wrap; }
  .scale-btn {
    flex: 1; min-width: 40px; padding: 9px 4px;
    border: 1.5px solid var(--border);
    border-radius: 10px; background: var(--cream);
    cursor: pointer; font-size: 13px; color: var(--gray-mid);
  }
  .scale-btn.selected { background: var(--sage); border-color: var(--sage); color: #F7F4EF; }

  .nav-row { display: flex; justify-content: space-between; align-items: center; margin-top: 40px; gap: 16px; }
  .btn-nav {
    padding: 13px 28px; border-radius: 10px; font-weight: 500; cursor: pointer;
    border: 1.5px solid var(--border); background: var(--warm-white); color: var(--gray-mid);
  }
  .btn-nav.primary { background: var(--sage); border-color: var(--sage); color: #F7F4EF; }

  /* ‚îÄ‚îÄ‚îÄ RESULTS SCREEN ‚îÄ‚îÄ‚îÄ */
  .results-wrap { max-width: 760px; margin: 0 auto; padding: 40px 24px 80px; }
  .results-header { text-align: center; margin-bottom: 48px; }
  .check-icon { width: 56px; height: 56px; background: var(--sage); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; }
  .check-icon svg { width:26px; height:26px; stroke: white; fill:none; stroke-width:2.5; }
  
  .patient-summary { background: var(--warm-white); border: 1px solid var(--border); border-radius: 14px; padding: 20px 24px; margin-bottom: 32px; display: flex; flex-wrap: wrap; gap: 20px; }
  .info-item label { font-size: 11px; text-transform: uppercase; color: var(--gray-mid); display: block; }
  .info-item span { font-size: 15px; font-weight: 500; }

  .domain-score-card { background: var(--warm-white); border: 1px solid var(--border); border-radius: 14px; padding: 20px 24px; margin-bottom: 12px; display: flex; align-items: center; gap: 20px; }
  .domain-bar-track { flex: 1; height: 8px; background: var(--gray-light); border-radius: 99px; overflow: hidden; }
  .domain-bar-fill { height: 100%; border-radius: 99px; }
  .score-low .domain-bar-fill { background: #C7B8B4; }
  .score-mid .domain-bar-fill { background: var(--terracotta-light); }
  .score-high .domain-bar-fill { background: var(--terracotta); }

  .send-section { text-align: center; margin-top: 40px; padding: 30px; border-top: 1px solid #E2DAD0; background-color: #F7F4EF; border-radius: 14px; }
  .send-status { margin-top: 12px; font-size: 13px; padding: 10px 14px; border-radius: 8px; display: none; }
  
  @media (max-width: 600px) { .form-row { grid-template-columns: 1fr; } .scale-btn .btn-label { display: none; } }
</style>
</head>
<body>

<div class="header">
  <div class="header-logo">
    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15v-4H7l5-8v4h4l-5 8z"/></svg>
  </div>
  <div>
    <div class="header-title">Invent√°rio de Esquemas de Young</div>
    <div class="header-subtitle">An√°lise cl√≠nica ‚Äî Sistema de Prontu√°rio Digital</div>
  </div>
  <div class="progress-bar-wrap" id="progressWrap" style="display:none">
    <div class="progress-track"><div class="progress-fill" id="progressFill"></div></div>
    <div class="progress-text" id="progressText">0 / 212</div>
  </div>
</div>

<div class="screen active" id="screenIntro">
<div class="intro-wrap">
  <div class="intro-badge">Cleo Martins - Psicoterapia</div>
  <h1 class="intro-heading">Question√°rio de<br><em>Invent√°rio de Esquemas</em></h1>
  <p class="intro-desc">Este invent√°rio ajudar√° a mapear seus padr√µes emocionais profundos para nossa jornada terap√™utica.</p>

  <div class="instructions-box">
    <h3>üìã Instru√ß√µes Importantes</h3>
    <p>Leia cada afirma√ß√£o e escolha a op√ß√£o que melhor descreve voc√™ <strong>emocionalmente</strong>. O teste √© dividido por blocos e voc√™ s√≥ poder√° avan√ßar ap√≥s completar todas as quest√µes de cada p√°gina.</p>
    <div class="scale-grid">
      <div class="scale-item"><div class="scale-num">1</div><div class="scale-label">Inteiramente falsa</div></div>
      <div class="scale-item"><div class="scale-num">6</div><div class="scale-label">Descreve-me perfeitamente</div></div>
    </div>
  </div>

  <div class="patient-form">
    <h3>Seus Dados Cadastrais</h3>
    <div class="form-row">
      <div class="form-group">
        <label>Nome Completo</label>
        <input type="text" id="pNome" placeholder="Seu nome"/>
      </div>
      <div class="form-group">
        <label>Idade</label>
        <input type="number" id="pIdade" placeholder="Ex: 48"/>
      </div>
    </div>
    <div class="form-row">
      <div class="form-group">
        <label>Data</label>
        <input type="date" id="pData"/>
      </div>
      <div class="form-group">
        <label>Profiss√£o</label>
        <input type="text" id="pProfissao" placeholder="Sua profiss√£o"/>
      </div>
    </div>
  </div>
  <button class="btn-start" onclick="startQuiz()">Iniciar Question√°rio ‚Üí</button>
</div>
</div>

<div class="screen" id="screenQuestions">
<div class="questions-wrap" id="questionsWrap"></div>
</div>

<div class="screen" id="screenResults">
<div class="results-wrap">
  <div class="results-header">
    <div class="check-icon"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>
    <h2>Avalia√ß√£o Conclu√≠da</h2>
    <p>Os dados foram processados e est√£o prontos para o seu prontu√°rio.</p>
  </div>

  <div class="patient-summary" id="patientSummary"></div>
  <div id="domainScores"></div>

  <div class="send-section">
    <h3 style="color: #4A2F26;">Finalizar e Sincronizar</h3>
    <p>Clique abaixo para salvar este diagn√≥stico diretamente no Consult√≥rio Virtual.</p>
    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
        <button id="btn-enviar" onclick="sendResults()" style="background-color: #4A2F26; color: #F7F4EF; padding: 14px 28px; border: none; cursor: pointer; font-weight: 500;">Sincronizar Prontu√°rio</button>
        <button onclick="window.print()" style="background-color: transparent; color: #4A2F26; padding: 14px 28px; border: 1px solid #4A2F26; cursor: pointer;">üñ®Ô∏è Gerar PDF</button>
    </div>
    <div id="sendStatus" class="send-status"></div>
  </div>
</div>
</div>

<script>
const domains = [
  { key:"pe", name:"Priva√ß√£o Emocional", questions:[1,2,3,4,5,6,7,8,9] },
  { key:"ab", name:"Abandono / Instabilidade", questions:[10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27] },
  { key:"da", name:"Desconfian√ßa / Abuso", questions:[28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44] },
  { key:"ia", name:"Isolamento Social / Aliena√ß√£o", questions:[45,46,47,48,49,50,51,52,53,54] },
  { key:"dv", name:"Defectividade / Vergonha", questions:[55,56,57,58,59,60,61,62,63,64,65,66,67,68,69] },
  { key:"np", name:"Negatividade / Pessimismo", questions:[70,71,72,73,74,75] },
  { key:"fr", name:"Fracasso", questions:[76,77,78,79,80,81,82,83,84] },
  { key:"di", name:"Depend√™ncia / Incompet√™ncia", questions:[85,86,87,88,89,90,91,92,93,94,95,96,97,98,99] },
  { key:"vd", name:"Vulnerabilidade ao Dano", questions:[100,101,102,103,104,105,106,107,108,109,110,111,112,113] },
  { key:"em", name:"Emaranhamento / Self Subdesenvolvido", questions:[114,115,116,117,118,119,120,121,122,123,124] },
  { key:"sb", name:"Subjuga√ß√£o", questions:[125,126,127,128,129,130,131,132,133,134] },
  { key:"as", name:"Autossacrif√≠cio", questions:[135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151] },
  { key:"ie", name:"Inibi√ß√£o Emocional", questions:[152,153,154,155,156,157,158,159,160] },
  { key:"pi", name:"Padr√µes Inflex√≠veis", questions:[161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176] },
  { key:"me", name:"Grandiosidade / Merecimento", questions:[177,178,179,180,181,182,183,184,185,186,187] },
  { key:"ai", name:"Autocontrole Insuficiente", questions:[188,189,190,191,192,193,194,195,196,197,198,199,200,201,202] },
  { key:"ba", name:"Busca de Aprova√ß√£o", questions:[203,204,205,206,207] },
  { key:"pp", name:"Autopuni√ß√£o / Puni√ß√£o", questions:[208,209,210,211,212] },
];

const allQuestions = [
  [1,"As pessoas n√£o conseguiram satisfazer minhas necessidades emocionais."],
  [2,"Eu n√£o recebi amor e aten√ß√£o."],
  [3,"De um modo geral, n√£o tenho ningu√©m para me dar conselhos e apoio emocional."],
  [4,"A maior parte do tempo, n√£o tenho ningu√©m para me dar carinho, compartilhar comigo e se importar profundamente com o que me acontece."],
  [5,"Eu n√£o tive ningu√©m que quisesse se aproximar e passar bastante tempo comigo em grande parte da minha vida."],
  [6,"Em geral, n√£o havia pessoas para me dar carinho, seguran√ßa e afei√ß√£o."],
  [7,"Eu n√£o senti que era especial para algu√©m, em grande parte da minha vida."],
  [8,"Em geral, n√£o tenho ningu√©m que realmente me escute, me compreenda ou esteja sintonizado com minhas verdadeiras necessidades e sentimentos."],
  [9,"Eu, raramente tenho alguma pessoa forte para me dar bons conselhos ou orienta√ß√£o quando n√£o tenho certeza do que fazer."],
  [10,"Eu me preocupo com a possibilidade de as pessoas que eu amo morrerem, mesmo que haja poucas raz√µes m√©dicas para confirmar minhas preocupa√ß√µes."],
  [11,"Percebo que me agarro √†s pessoas com as quais tenho intimidade, por ter medo de que elas me deixem."],
  [12,"Eu me preocupo com a possibilidade das pessoas que gosto me deixarem ou me abandonarem."],
  [13,"Sinto que me falta uma base est√°vel de apoio emocional."],
  [14,"N√£o espero que os relacionamentos importantes durem; acredito que eles v√£o terminar."],
  [15,"Sinto que me apego a parceiros/as que n√£o s√£o capazes de se comprometerem comigo."],
  [16,"No final, acabarei s√≥."],
  [17,"Quando sinto que algu√©m com quem eu me importo est√° se afastando, fico desesperado."],
  [18,"√Äs vezes, tenho tanto medo de que as pessoas me deixem que acabo fazendo com que se afastem."],
  [19,"Fico incomodado quando algu√©m me deixa sozinho, mesmo que por pouco tempo."],
  [20,"N√£o posso esperar que as pessoas que me ap√≥iam estejam sempre dispon√≠veis."],
  [21,"N√£o devo ficar realmente √≠ntimo das pessoas, porque n√£o posso ter certeza de que poderei contar sempre com elas."],
  [22,"Parece que as pessoas importantes da minha vida est√£o sempre indo e vindo."],
  [23,"Tenho muito medo de que as pessoas que eu amo encontrem algu√©m que v√£o preferir e me deixem."],
  [24,"As pessoas que me s√£o pr√≥ximas t√™m sido muito imprevis√≠veis; ora s√£o legais, ora est√£o zangadas."],
  [25,"Preciso tanto das pessoas que tenho medo de perd√™-las."],
  [26,"Eu me sinto indefeso se n√£o tiver pessoas para me proteger."],
  [27,"N√£o posso ser eu mesmo ou expressar o que realmente sinto, pois as pessoas me deixariam."],
  [28,"Sinto que as pessoas querem tirar vantagem de mim."],
  [29,"Frequentemente, sinto que tenho que me proteger dos outros."],
  [30,"Sinto que n√£o posso baixar a guarda na presen√ßa dos outros, pois eles me prejudicariam."],
  [31,"Se uma pessoa √© legal comigo, fico imaginando que ela est√° querendo alguma coisa."],
  [32,"√â s√≥ uma quest√£o de tempo antes que as pessoas me traiam."],
  [33,"A maioria das pessoas s√≥ pensa em si mesma."],
  [34,"Tenho grande dificuldade em confiar nas pessoas."],
  [35,"Desconfio muito dos motivos dos outros."],
  [36,"As outras pessoas raramente s√£o honestas; elas geralmente n√£o s√£o o que parecem."],
  [37,"Eu geralmente fico procurando os motivos escondidos das pessoas."],
  [38,"Se acho que algu√©m quer me prejudicar, tento prejudic√°-la/o primeiro."],
  [39,"As pessoas t√™m de provar coisas para mim antes que eu confie nelas."],
  [40,"Invento 'testes' para as pessoas para ver se elas est√£o me dizendo a verdade."],
  [41,"Acredito no ditado: 'quem n√£o controla √© controlado'."],
  [42,"Fico com raiva quando penso como fui maltratado pelas pessoas."],
  [43,"Pessoas que me eram pr√≥ximas tiraram vantagem de mim."],
  [44,"Fui abusado fisicamente, emocionalmente ou sexualmente por pessoas importantes."],
  [45,"Eu n√£o me encaixo."],
  [46,"Sou fundamentalmente diferente das outras pessoas."],
  [47,"Eu n√£o perten√ßo a ningu√©m; sou um solit√°rio."],
  [48,"Sinto-me alienado das outras pessoas."],
  [49,"Eu me sinto isolado e sozinho."],
  [50,"Sempre me sinto exclu√≠da dos grupos."],
  [51,"Ningu√©m me entende realmente."],
  [52,"A minha fam√≠lia sempre foi diferente das fam√≠lias que nos cercavam."],
  [53,"√Äs vezes, me sinto um alien√≠gena."],
  [54,"Se eu desaparecesse amanh√£, ningu√©m perceberia."],
  [55,"Ningu√©m me amar√° depois de saber dos meus defeitos."],
  [56,"Ningu√©m vai querer ficar perto de mim depois que conhecer meu verdadeiro eu."],
  [57,"Sou inerentemente defeituoso e cheio de falhas."],
  [58,"N√£o conseguirei que algu√©m sinta que eu tenho valor."],
  [59,"N√£o sou digno do amor, da aten√ß√£o e do respeito dos outros."],
  [60,"Sinto que n√£o mere√ßo ser amado."],
  [61,"Sou inaceit√°vel demais para me revelar aos outros."],
  [62,"Se as pessoas descobrissem meus defeitos, eu n√£o conseguiria encar√°-las."],
  [63,"Quando as pessoas gostam de mim, sinto que as estou enganando."],
  [64,"Sou atra√≠do por pessoas que s√£o muito cr√≠ticas ou me rejeitam."],
  [65,"Tenho segredos que eu n√£o quero que descubram."],
  [66,"Foi por minha culpa que meus pais n√£o conseguiram me amar."],
  [67,"N√£o deixo que as pessoas conhe√ßam meu verdadeiro eu."],
  [68,"Um dos meus maiores medos √© que meus defeitos sejam expostos."],
  [69,"N√£o posso compreender como ningu√©m conseguiu me amar."],
  [70,"Mesmo quando as coisas v√£o bem, sinto que √© tempor√°rio."],
  [71,"Se algo de bom acontecer, fico preocupado se algo ruim vir√° depois."],
  [72,"Todo cuidado √© pouco; quase sempre alguma coisa vai mal."],
  [73,"Fico preocupado com a possibilidade de ficar na mis√©ria."],
  [74,"As pessoas n√£o iriam querer se associar a mim devido ao meu status."],
  [75,"Preocupo-me que uma decis√£o errada provoque uma cat√°strofe."],
  [76,"Quase nada do que eu fa√ßo √© t√£o bom quanto o que os outros fazem."],
  [77,"Sou incompetente no que se refere √†s realiza√ß√µes."],
  [78,"A maioria das pessoas √© mais capaz do que eu."],
  [79,"Eu sou um fracasso."],
  [80,"N√£o tenho tanto talento quanto a maioria das pessoas."],
  [81,"N√£o sou t√£o inteligente quanto a maioria das pessoas."],
  [82,"Sinto-me humilhado por meus fracassos."],
  [83,"Sinto-me embara√ßado perto das pessoas porque n√£o estou √† altura."],
  [84,"Comparo minhas realiza√ß√µes e acho que os outros s√£o mais bem-sucedidos."],
  [85,"N√£o me sinto capaz de me arranjar sozinho no dia-a-dia."],
  [86,"Preciso que as outras pessoas me ajudem a fazer as coisas."],
  [87,"N√£o me sinto capaz de manejar bem as situa√ß√µes sem ajuda."],
  [88,"Acredito que as pessoas podem cuidar melhor de mim do que eu mesmo."],
  [89,"Tenho dificuldade em lidar com tarefas novas sozinho."],
  [90,"Penso em mim como uma pessoa dependente."],
  [91,"Acabo estragando tudo o que tento fazer."],
  [92,"Sou incapaz em quase todas as √°reas da vida."],
  [93,"Se eu confiar no meu pr√≥prio julgamento, tomarei a decis√£o errada."],
  [94,"Falta-me bom senso."],
  [95,"N√£o se pode confiar em meu julgamento."],
  [96,"N√£o confio em minha capacidade de resolver problemas."],
  [97,"Sinto que preciso de algu√©m para me dar conselhos pr√°ticos."],
  [98,"Sinto-me mais como uma crian√ßa do que como adulto no cotidiano."],
  [99,"Acho as responsabilidades do dia-a-dia esmagadoras."],
  [100,"N√£o consigo deixar de sentir que algo de ruim vai acontecer."],
  [101,"Sinto que algum desastre vai acontecer a qualquer momento."],
  [102,"Tenho medo de me tornar um 'sem-teto'."],
  [103,"Tenho medo de ser atacado."],
  [104,"Sinto que devo ter muito cuidado com dinheiro."],
  [105,"Tomo muitas precau√ß√µes para n√£o adoecer."],
  [106,"Tenho medo de perder todo o meu dinheiro."],
  [107,"Tenho medo de pegar uma doen√ßa s√©ria sem diagn√≥stico."],
  [108,"Sou uma pessoa medrosa."],
  [109,"Preocupo-me com crime, polui√ß√£o e coisas horr√≠veis do mundo."],
  [110,"Muitas vezes, acho que posso enlouquecer."],
  [111,"Sinto que vou ter um ataque de ansiedade."],
  [112,"Tenho medo de ter um ataque card√≠aco sem raz√£o m√©dica."],
  [113,"Acho que o mundo √© um lugar perigoso."],
  [114,"N√£o consegui me separar de meus pais."],
  [115,"Meus pais e eu nos envolvemos excessivamente na vida um do outro."],
  [116,"√â dif√≠cil esconder detalhes √≠ntimos dos meus pais."],
  [117,"Temos que nos falar quase todos os dias ou nos sentimos culpados."],
  [118,"N√£o tenho uma identidade separada da de meus pais ou parceiro/a."],
  [119,"Sinto que meus pais est√£o vivendo por interm√©dio de mim."],
  [120,"N√£o √© f√°cil para eu ter um senso separado de mim mesmo."],
  [121,"N√£o sei realmente quem sou ou o que quero fora da rela√ß√£o."],
  [122,"Tenho dificuldade em separar meu ponto de vista do deles."],
  [123,"Sinto que n√£o tenho privacidade em rela√ß√£o a eles."],
  [124,"Meus pais ficam magoados por eu morar sozinho."],
  [125,"Deixo as pessoas fazerem o que querem por medo das conseq√º√™ncias."],
  [126,"Se eu fizer o que quero, s√≥ vou arranjar problemas."],
  [127,"Cedo ao desejo das pessoas para evitar rejei√ß√£o ou retalia√ß√£o."],
  [128,"Nos meus relacionamentos, deixo a outra pessoa ter o controle."],
  [129,"Deixo os outros escolherem por mim; n√£o sei o que quero."],
  [130,"As maiores decis√µes da minha vida n√£o foram realmente minhas."],
  [131,"Preocupo-me muito em agradar os outros para n√£o ser rejeitado."],
  [132,"Tenho dificuldade em exigir que meus direitos sejam respeitados."],
  [133,"Vingo-me das pessoas de maneira sutil em vez de mostrar raiva."],
  [134,"Vou muito al√©m do comum para evitar confronta√ß√µes."],
  [135,"Coloco as necessidades dos outros antes das minhas por culpa."],
  [136,"Sinto culpa quando desaponto as pessoas."],
  [137,"Dou mais √†s pessoas do que recebo delas."],
  [138,"Sou eu quem cuida das pessoas pr√≥ximas."],
  [139,"N√£o h√° nada que n√£o possa aceitar quando amo algu√©m."],
  [140,"Sou boa pessoa pois penso nos outros mais do que em mim."],
  [141,"No trabalho, sou o volunt√°rio para tarefas extras."],
  [142,"Sempre arranjo tempo para os outros, por mais ocupado que esteja."],
  [143,"Consigo me virar com muito pouco; minhas necessidades s√£o m√≠nimas."],
  [144,"S√≥ me sinto feliz quando aqueles ao meu redor est√£o felizes."],
  [145,"Tenho pouco tempo para mim de tanto cuidar dos outros."],
  [146,"Sempre fui quem escuta os problemas de todo mundo."],
  [147,"Fico mais √† vontade dando presente do que recebendo."],
  [148,"As pessoas me v√™em fazendo muito pelos outros e pouco por mim."],
  [149,"Por mais que eu d√™, nunca √© suficiente."],
  [150,"Se fa√ßo o que quero, me sinto muito mal."],
  [151,"√â muito dif√≠cil pedir que atendam √†s minhas necessidades."],
  [152,"Tenho medo de perder o controle das minhas a√ß√µes."],
  [153,"Ten o medo de machucar as pessoas se perder o controle."],
  [154,"Preciso controlar minhas emo√ß√µes ou algo ruim acontece."],
  [155,"H√° muita raiva e ressentimento dentro de mim que n√£o expresso."],
  [156,"Tenho vergonha de demonstrar sentimentos positivos (carinho)."],
  [157,"Acho embara√ßoso expressar meus sentimentos."],
  [158,"Tenho dificuldade em ser carinhoso e espont√¢neo."],
  [159,"As pessoas acham que eu n√£o sou emotivo de tanto que me controlo."],
  [160,"As pessoas me v√™em como emocionalmente contida."],
  [161,"Preciso ser o melhor; n√£o aceito vir em segundo lugar."],
  [162,"Tento manter tudo na mais perfeita ordem."],
  [163,"Preciso causar a melhor impress√£o o tempo todo."],
  [164,"Tento fazer o melhor; n√£o aceito o 'suficientemente bom'."],
  [165,"Quase n√£o me sobra tempo para relaxar de verdade."],
  [166,"Quase nada √© bom o bastante; sempre posso melhorar."],
  [167,"Preciso cumprir todas as minhas responsabilidades."],
  [168,"Sinto press√£o constante para conquistar e fazer as coisas."],
  [169,"Meus relacionamentos sofrem porque exijo demais de mim."],
  [170,"Minha sa√∫de sofre porque me pressiono demais."],
  [171,"Sacrifico prazer e felicidade para estar √† altura dos meus padr√µes."],
  [172,"Se cometo erro, mere√ßo ser muito criticado."],
  [173,"N√£o consigo me desculpar por erros com facilidade."],
  [174,"Sou uma pessoa muito competitiva."],
  [175,"Dou muito valor a dinheiro e status."],
  [176,"Tenho que ser sempre o 'N√∫mero 1'."],
  [177,"Tenho dificuldade em aceitar um 'n√£o' quando quero algo."],
  [178,"Zango-me quando n√£o consigo o que quero."],
  [179,"Sou especial e n√£o deveria aceitar as restri√ß√µes dos outros."],
  [180,"Detesto ser obrigado a fazer algo ou ser impedido."],
  [181,"N√£o deveria ter que obedecer regras normais como os outros."],
  [182,"O que eu ofere√ßo √© mais valioso que a contribui√ß√£o dos outros."],
  [183,"Coloco minhas necessidades acima das necessidades alheias."],
  [184,"Prioridades minhas me tiram o tempo para amigos ou fam√≠lia."],
  [185,"Dizem que sou muito controlador sobre como as coisas devem ser."],
  [186,"Fico irritado quando as pessoas n√£o fazem o que pe√ßo."],
  [187,"N√£o tolero que me digam o que fazer."],
  [188,"Dificuldade em parar de beber, fumar ou comer demais."],
  [189,"N√£o consigo me disciplinar em tarefas rotineiras ou chatas."],
  [190,"Obede√ßo impulsos que me trazem problemas."],
  [191,"Quando n√£o atinjo objetivo, desisto facilmente."],
  [192,"Dif√≠cil sacrificar gratifica√ß√£o imediata por objetivo longo."],
  [193,"N√£o consigo controlar a raiva depois que come√ßo."],
  [194,"Tendo a fazer coisas em excesso sabendo que √© ruim."],
  [195,"Aborre√ßo-me muito facilmente."],
  [196,"N√£o consigo perseverar em tarefas dif√≠ceis."],
  [197,"N√£o consigo me concentrar por muito tempo."],
  [198,"N√£o consigo me obrigar a fazer o que n√£o gosto."],
  [199,"Perco a calma diante da ofensa mais insignificante."],
  [200,"Raramente cumpro minhas resolu√ß√µes."],
  [201,"Mostro √†s pessoas o que sinto, seja qual for o custo."],
  [202,"Fa√ßo coisas por impulso que depois lamento."],
  [203,"Dinheiro e status me fazem sentir valor."],
  [204,"Minhas conquistas valem mais se os outros repararem."],
  [205,"Sinto-me pouco importante sem aten√ß√£o dos outros."],
  [206,"Importante obter reconhecimento e admira√ß√£o em grupos."],
  [207,"Elogios me fazem sentir como pessoa de valor."],
  [208,"Se cometer erro, mere√ßo castigo."],
  [209,"Se n√£o me esfor√ßar ao m√°ximo, √© de esperar que corra mal."],
  [210,"Se n√£o fizer bem o que me compete, mere√ßo sofrer consequ√™ncias."],
  [211,"Quando fa√ßo algo errado, √© preciso arcar com as consequ√™ncias."],
  [212,"Sou uma pessoa m√° que merece ser castigada."]
];

const answers = {};
let currentDomainIdx = 0;

function updateProgress() {
  const answered = Object.keys(answers).length;
  const pct = (answered / 212) * 100;
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressText').textContent = answered + ' / 212';
}

function startQuiz() {
  const nome = document.getElementById('pNome').value;
  if(!nome) { alert("Por favor, insira seu nome para come√ßar."); return; }
  
  const dateInput = document.getElementById('pData');
  if (!dateInput.value) dateInput.value = new Date().toISOString().split('T')[0];

  document.getElementById('progressWrap').style.display = 'flex';
  showScreen('screenQuestions');
  renderDomain(0);
}

function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function renderDomain(domainIdx) {
  currentDomainIdx = domainIdx;
  const domain = domains[domainIdx];
  const wrap = document.getElementById('questionsWrap');

  let html = `
    <div class="domain-header">
      <div class="domain-tag">M√≥dulo ${domainIdx + 1} de ${domains.length}</div>
      <div class="domain-name">${domain.name}</div>
    </div>
  `;

  domain.questions.forEach(qNum => {
    const qData = allQuestions.find(q => q[0] === qNum);
    const isAnswered = answers[qNum] !== undefined;
    html += `
      <div class="question-card ${isAnswered ? 'answered' : ''}" id="qcard-${qNum}">
        <div class="question-header">
          <div class="question-num">${isAnswered ? '‚úì' : qNum}</div>
          <div class="question-text">${qData[1]}</div>
        </div>
        <div class="scale-options">
          ${[1,2,3,4,5,6].map(v => `
            <button class="scale-btn ${answers[qNum] === v ? 'selected' : ''}" 
              onclick="selectAnswer(${qNum}, ${v}, this)">${v}</button>
          `).join('')}
        </div>
      </div>
    `;
  });

  html += `
    <div class="nav-row">
      ${domainIdx > 0 ? `<button class="btn-nav" onclick="renderDomain(${domainIdx - 1})">‚Üê Voltar</button>` : `<div></div>`}
      <div id="status-pag" style="color:var(--gray-mid); font-size:13px"></div>
      <button class="btn-nav primary" onclick="validarEAvan√ßar()">
        ${domainIdx < domains.length - 1 ? 'Pr√≥ximo Passo ‚Üí' : 'Ver Resultados ‚Üí'}
      </button>
    </div>
  `;

  wrap.innerHTML = html;
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function selectAnswer(qNum, val, btn) {
  answers[qNum] = val;
  const card = document.getElementById('qcard-' + qNum);
  card.classList.remove('missing');
  card.classList.add('answered');
  card.querySelector('.question-num').textContent = '‚úì';
  btn.closest('.scale-options').querySelectorAll('.scale-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  updateProgress();
}

function validarEAvan√ßar() {
  const domain = domains[currentDomainIdx];
  const faltantes = domain.questions.filter(q => answers[q] === undefined);

  if (faltantes.length > 0) {
    faltantes.forEach(q => document.getElementById('qcard-' + q).classList.add('missing'));
    alert(`‚ö†Ô∏è Aten√ß√£o: Faltam ${faltantes.length} quest√µes neste bloco. Por favor, responda todas para prosseguir.`);
    document.getElementById('qcard-' + faltantes[0]).scrollIntoView({ behavior: 'smooth', block: 'center' });
    return;
  }

  if (currentDomainIdx < domains.length - 1) {
    renderDomain(currentDomainIdx + 1);
  } else {
    showResults();
  }
}

function showResults() {
  showScreen('screenResults');
  window.scrollTo(0, 0);

  const nome = document.getElementById('pNome').value;
  const idade = document.getElementById('pIdade').value;
  const prof = document.getElementById('pProfissao').value;
  const data = document.getElementById('pData').value;
  const dataFmt = data ? new Date(data + 'T12:00:00').toLocaleDateString('pt-BR') : '‚Äî';

  document.getElementById('patientSummary').innerHTML = `
    <div class="info-item"><label>Nome</label><span>${nome}</span></div>
    <div class="info-item"><label>Idade</label><span>${idade}</span></div>
    <div class="info-item"><label>Data</label><span>${dataFmt}</span></div>
    <div class="info-item"><label>Profiss√£o</label><span>${prof}</span></div>
  `;

  let scoresHtml = '';
  domains.forEach(domain => {
    const qs = domain.questions.filter(q => answers[q] !== undefined);
    const avg = (qs.reduce((sum, q) => sum + answers[q], 0) / qs.length).toFixed(2);
    const pct = ((avg - 1) / 5) * 100;
    const scoreClass = avg < 2.5 ? 'score-low' : avg < 4 ? 'score-mid' : 'score-high';
    scoresHtml += `
      <div class="domain-score-card ${scoreClass}">
        <div style="flex:1"><strong>${domain.name}</strong></div>
        <div style="flex:2; display:flex; align-items:center; gap:10px">
          <div class="domain-bar-track"><div class="domain-bar-fill" style="width:${pct}%"></div></div>
          <div style="font-weight:600; min-width:35px">${avg}</div>
        </div>
      </div>`;
  });
  document.getElementById('domainScores').innerHTML = scoresHtml;
}

async function sendResults() {
  const statusEl = document.getElementById('sendStatus');
  const btn = document.getElementById('btn-enviar');
  
  btn.disabled = true;
  btn.textContent = 'Sincronizando...';
  statusEl.style.display = 'block';
  statusEl.textContent = 'Conectando ao Consult√≥rio Virtual...';

  // Gerar texto dos resultados
  let scoresText = domains.map(d => {
      const qInD = d.questions;
      const avg = (qInD.reduce((s, q) => s + (answers[q]||0), 0) / qInD.length).toFixed(2);
      return `${d.name}: ${avg}`;
  }).join(' | ');

  try {
    const response = await fetch('https://nyelqgsqpqoasywdioxi.supabase.co/rest/v1/clientes', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'apikey': 'sb_publishable_IVMMnw4_9uF4C6-RBiElUg_lvIq8JRX',
        'Authorization': 'Bearer sb_publishable_IVMMnw4_9uF4C6-RBiElUg_lvIq8JRX',
        'Prefer': 'return=minimal'
      },
      body: JSON.stringify({
        nome_completo: document.getElementById('pNome').value,
        anotacoes: `Idade: ${document.getElementById('pIdade').value} | Profiss√£o: ${document.getElementById('pProfissao').value}`,
        origem: "Invent√°rio de Esquemas",
        resultados_teste: { dominios: scoresText, data: new Date().toLocaleDateString() }
      })
    });

    if (response.ok) {
      statusEl.style.color = '#687C5A';
      statusEl.textContent = '‚úÖ Sucesso! O diagn√≥stico foi salvo no prontu√°rio.';
      btn.textContent = 'Sincronizado ‚úî';
    } else { throw new Error(); }
  } catch (err) {
    statusEl.style.color = '#A84848';
    statusEl.textContent = '‚ùå Erro ao salvar. Por favor, tente novamente ou gere o PDF.';
    btn.disabled = false;
    btn.textContent = 'Tentar Novamente';
  }
}
</script>
</body>
</html>
